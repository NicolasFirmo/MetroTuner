#include "notes.h"

static constexpr std::array<double, 108> frequencies{
	16.35,	 17.32,	  18.35,   19.45,	20.60,	 21.83,	  23.12,   24.50,	25.96,	 27.50,
	29.14,	 30.87,	  32.70,   34.65,	36.71,	 38.89,	  41.20,   43.65,	46.25,	 49.00,
	51.91,	 55.00,	  58.27,   61.74,	65.41,	 69.30,	  73.42,   77.78,	82.41,	 87.31,
	92.50,	 98.00,	  103.83,  110.00,	116.54,	 123.47,  130.81,  138.59,	146.83,	 155.56,
	164.81,	 174.61,  185.00,  196.00,	207.65,	 220.00,  233.08,  246.94,	261.63,	 277.18,
	293.66,	 311.13,  329.63,  349.23,	369.99,	 392.00,  415.30,  440.00,	466.16,	 493.88,
	523.25,	 554.37,  587.33,  622.25,	659.25,	 698.46,  739.99,  783.99,	830.61,	 880.00,
	932.33,	 987.77,  1046.50, 1108.73, 1174.66, 1244.51, 1318.51, 1396.91, 1479.98, 1567.98,
	1661.22, 1760.00, 1864.66, 1975.53, 2093.00, 2217.46, 2349.32, 2489.02, 2637.02, 2793.83,
	2959.96, 3135.96, 3322.44, 3520.00, 3729.31, 3951.07, 4186.01, 4434.92, 4698.63, 4978.03,
	5274.04, 5587.65, 5919.91, 6271.93, 6644.88, 7040.00, 7458.62, 7902.13};

Note::Note(const double frequency) : frequency_(frequency), note_(frequencies.size()), cents_(0) {
	if (frequency >= frequencies[0]) {
		while (frequencies[--note_] > frequency) {}

		const auto aboveNoteFreq = frequencies[static_cast<Name>(note_ + 1)];
		cents_ = 1200 * log2(aboveNoteFreq / frequency);
	}
}

std::string_view Note::getSharpName() const {
	switch (static_cast<Name>(note_)) {
	case C0:
		return "C0";
	case Cs0:
		return "C#0";
	case D0:
		return "D0";
	case Ds0:
		return "D#0";
	case E0:
		return "E0";
	case F0:
		return "F0";
	case Fs0:
		return "F#0";
	case G0:
		return "G0";
	case Gs0:
		return "G#0";
	case A0:
		return "A0";
	case As0:
		return "A#0";
	case B0:
		return "B0";
	case C1:
		return "C1";
	case Cs1:
		return "C#1";
	case D1:
		return "D1";
	case Ds1:
		return "D#1";
	case E1:
		return "E1";
	case F1:
		return "F1";
	case Fs1:
		return "F#1";
	case G1:
		return "G1";
	case Gs1:
		return "G#1";
	case A1:
		return "A1";
	case As1:
		return "A#1";
	case B1:
		return "B1";
	case C2:
		return "C2";
	case Cs2:
		return "C#2";
	case D2:
		return "D2";
	case Ds2:
		return "D#2";
	case E2:
		return "E2";
	case F2:
		return "F2";
	case Fs2:
		return "F#2";
	case G2:
		return "G2";
	case Gs2:
		return "G#2";
	case A2:
		return "A2";
	case As2:
		return "A#2";
	case B2:
		return "B2";
	case C3:
		return "C3";
	case Cs3:
		return "C#3";
	case D3:
		return "D3";
	case Ds3:
		return "D#3";
	case E3:
		return "E3";
	case F3:
		return "F3";
	case Fs3:
		return "F#3";
	case G3:
		return "G3";
	case Gs3:
		return "G#3";
	case A3:
		return "A3";
	case As3:
		return "A#3";
	case B3:
		return "B3";
	case C4:
		return "C4";
	case Cs4:
		return "C#4";
	case D4:
		return "D4";
	case Ds4:
		return "D#4";
	case E4:
		return "E4";
	case F4:
		return "F4";
	case Fs4:
		return "F#4";
	case G4:
		return "G4";
	case Gs4:
		return "G#4";
	case A4:
		return "A4";
	case As4:
		return "A#4";
	case B4:
		return "B4";
	case C5:
		return "C5";
	case Cs5:
		return "C#5";
	case D5:
		return "D5";
	case Ds5:
		return "D#5";
	case E5:
		return "E5";
	case F5:
		return "F5";
	case Fs5:
		return "F#5";
	case G5:
		return "G5";
	case Gs5:
		return "G#5";
	case A5:
		return "A5";
	case As5:
		return "A#5";
	case B5:
		return "B5";
	case C6:
		return "C6";
	case Cs6:
		return "C#6";
	case D6:
		return "D6";
	case Ds6:
		return "D#6";
	case E6:
		return "E6";
	case F6:
		return "F6";
	case Fs6:
		return "F#6";
	case G6:
		return "G6";
	case Gs6:
		return "G#6";
	case A6:
		return "A6";
	case As6:
		return "A#6";
	case B6:
		return "B6";
	case C7:
		return "C7";
	case Cs7:
		return "C#7";
	case D7:
		return "D7";
	case Ds7:
		return "D#7";
	case E7:
		return "E7";
	case F7:
		return "F7";
	case Fs7:
		return "F#7";
	case G7:
		return "G7";
	case Gs7:
		return "G#7";
	case A7:
		return "A7";
	case As7:
		return "A#7";
	case B7:
		return "B7";
	case C8:
		return "C8";
	case Cs8:
		return "C#8";
	case D8:
		return "D8";
	case Ds8:
		return "D#8";
	case E8:
		return "E8";
	case F8:
		return "F8";
	case Fs8:
		return "F#8";
	case G8:
		return "G8";
	case Gs8:
		return "G#8";
	case A8:
		return "A8";
	case As8:
		return "A#8";
	case B8:
		return "B8";
	}
	return "";
}
std::string_view Note::getFlatName() const {
	switch (static_cast<Name>(note_)) {
	case C0:
		return "C0";
	case Db0:
		return "Db0";
	case D0:
		return "D0";
	case Eb0:
		return "Eb0";
	case E0:
		return "E0";
	case F0:
		return "F0";
	case Gb0:
		return "Gb0";
	case G0:
		return "G0";
	case Ab0:
		return "Ab0";
	case A0:
		return "A0";
	case Bb0:
		return "Bb0";
	case B0:
		return "B0";
	case C1:
		return "C1";
	case Db1:
		return "Db1";
	case D1:
		return "D1";
	case Eb1:
		return "Eb1";
	case E1:
		return "E1";
	case F1:
		return "F1";
	case Gb1:
		return "Gb1";
	case G1:
		return "G1";
	case Ab1:
		return "Ab1";
	case A1:
		return "A1";
	case Bb1:
		return "Bb1";
	case B1:
		return "B1";
	case C2:
		return "C2";
	case Db2:
		return "Db2";
	case D2:
		return "D2";
	case Eb2:
		return "Eb2";
	case E2:
		return "E2";
	case F2:
		return "F2";
	case Gb2:
		return "Gb2";
	case G2:
		return "G2";
	case Ab2:
		return "Ab2";
	case A2:
		return "A2";
	case Bb2:
		return "Bb2";
	case B2:
		return "B2";
	case C3:
		return "C3";
	case Db3:
		return "Db3";
	case D3:
		return "D3";
	case Eb3:
		return "Eb3";
	case E3:
		return "E3";
	case F3:
		return "F3";
	case Gb3:
		return "Gb3";
	case G3:
		return "G3";
	case Ab3:
		return "Ab3";
	case A3:
		return "A3";
	case Bb3:
		return "Bb3";
	case B3:
		return "B3";
	case C4:
		return "C4";
	case Db4:
		return "Db4";
	case D4:
		return "D4";
	case Eb4:
		return "Eb4";
	case E4:
		return "E4";
	case F4:
		return "F4";
	case Gb4:
		return "Gb4";
	case G4:
		return "G4";
	case Ab4:
		return "Ab4";
	case A4:
		return "A4";
	case Bb4:
		return "Bb4";
	case B4:
		return "B4";
	case C5:
		return "C5";
	case Db5:
		return "Db5";
	case D5:
		return "D5";
	case Eb5:
		return "Eb5";
	case E5:
		return "E5";
	case F5:
		return "F5";
	case Gb5:
		return "Gb5";
	case G5:
		return "G5";
	case Ab5:
		return "Ab5";
	case A5:
		return "A5";
	case Bb5:
		return "Bb5";
	case B5:
		return "B5";
	case C6:
		return "C6";
	case Db6:
		return "Db6";
	case D6:
		return "D6";
	case Eb6:
		return "Eb6";
	case E6:
		return "E6";
	case F6:
		return "F6";
	case Gb6:
		return "Gb6";
	case G6:
		return "G6";
	case Ab6:
		return "Ab6";
	case A6:
		return "A6";
	case Bb6:
		return "Bb6";
	case B6:
		return "B6";
	case C7:
		return "C7";
	case Db7:
		return "Db7";
	case D7:
		return "D7";
	case Eb7:
		return "Eb7";
	case E7:
		return "E7";
	case F7:
		return "F7";
	case Gb7:
		return "Gb7";
	case G7:
		return "G7";
	case Ab7:
		return "Ab7";
	case A7:
		return "A7";
	case Bb7:
		return "Bb7";
	case B7:
		return "B7";
	case C8:
		return "C8";
	case Db8:
		return "Db8";
	case D8:
		return "D8";
	case Eb8:
		return "Eb8";
	case E8:
		return "E8";
	case F8:
		return "F8";
	case Gb8:
		return "Gb8";
	case G8:
		return "G8";
	case Ab8:
		return "Ab8";
	case A8:
		return "A8";
	case Bb8:
		return "Bb8";
	case B8:
		return "B8";
	}
	return "";
}